/*
 Highcharts JS v8.1.2 (2020-08-13)

 Exporting module

 (c) 2010-2019 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(a){"object"===typeof module&&module.exports?(a["default"]=a,module.exports=a):"function"===typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){a(e);a.Highcharts=e;return a}):a("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(a){function e(a,b,f,c){a.hasOwnProperty(b)||(a[b]=c.apply(null,f))}a=a?a._modules:{};e(a,"Extensions/DownloadURL.js",[a["Core/Globals.js"]],function(a){var b=a.win,f=b.navigator,c=b.document,
e=b.URL||b.webkitURL||b,q=/Edge\/\d+/.test(f.userAgent),u=a.dataURLtoBlob=function(d){if((d=d.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<d.length&&b.atob&&b.ArrayBuffer&&b.Uint8Array&&b.Blob&&e.createObjectURL){var a=b.atob(d[3]),c=new b.ArrayBuffer(a.length);c=new b.Uint8Array(c);for(var f=0;f<c.length;++f)c[f]=a.charCodeAt(f);d=new b.Blob([c],{type:d[1]});return e.createObjectURL(d)}};a=a.downloadURL=function(a,p){var d=c.createElement("a");if("string"===typeof a||a instanceof String||
!f.msSaveOrOpenBlob){a=""+a;if(q||2E6<a.length)if(a=u(a)||"",!a)throw Error("Failed to convert to blob");if("undefined"!==typeof d.download)d.href=a,d.download=p,c.body.appendChild(d),d.click(),c.body.removeChild(d);else try{var e=b.open(a,"chart");if("undefined"===typeof e||null===e)throw Error("Failed to open window");}catch(D){b.location.href=a}}else f.msSaveOrOpenBlob(a,p)};return{dataURLtoBlob:u,downloadURL:a}});e(a,"Extensions/ExportData.js",[a["Core/Axis/Axis.js"],a["Core/Chart/Chart.js"],
a["Core/Globals.js"],a["Core/Utilities.js"],a["Extensions/DownloadURL.js"]],function(a,b,f,c,e){function q(a,b){var d=p.navigator,t=-1<d.userAgent.indexOf("WebKit")&&0>d.userAgent.indexOf("Chrome"),c=p.URL||p.webkitURL||p;try{if(d.msSaveOrOpenBlob&&p.MSBlobBuilder){var r=new p.MSBlobBuilder;r.append(a);return r.getBlob("image/svg+xml")}if(!t)return c.createObjectURL(new p.Blob(["\ufeff"+a],{type:b}))}catch(M){}}var u=f.doc,d=f.seriesTypes,p=f.win,H=c.addEvent,I=c.defined;f=c.extend;var D=c.find,B=
c.fireEvent,K=c.getOptions,L=c.isNumber,v=c.pick;c=c.setOptions;var E=e.downloadURL;c({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table"}});
H(b,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()});b.prototype.setUpKeyToAxis=function(){d.arearange&&(d.arearange.prototype.keyToAxis={low:"y",high:"y"});d.gantt&&(d.gantt.prototype.keyToAxis={start:"x",end:"x"})};b.prototype.getDataRows=function(b){var d=this.hasParallelCoordinates,c=this.time,t=this.options.exporting&&this.options.exporting.csv||{},f=this.xAxis,r={},e=[],p=[],C=[],n;var k=this.options.lang.exportData;
var y=k.categoryHeader,g=k.categoryDatetimeHeader,F=function(l,d,c){if(t.columnHeaderFormatter){var h=t.columnHeaderFormatter(l,d,c);if(!1!==h)return h}return l?l instanceof a?l.options.title&&l.options.title.text||(l.dateTime?g:y):b?{columnTitle:1<c?d:l.name,topLevelColumnTitle:l.name}:l.name+(1<c?" ("+d+")":""):y},G=function(l,a,b){var d={},c={};a.forEach(function(a){var g=(l.keyToAxis&&l.keyToAxis[a]||a)+"Axis";g=L(b)?l.chart[g][b]:l[g];d[a]=g&&g.categories||[];c[a]=g&&g.dateTime});return{categoryMap:d,
dateTimeValueAxisMap:c}},w=function(a,b){return a.data.filter(function(a){return"undefined"!==typeof a.y&&a.name}).length&&b&&!b.categories&&!a.keyToAxis?a.pointArrayMap&&a.pointArrayMap.filter(function(a){return"x"===a}).length?(a.pointArrayMap.unshift("x"),a.pointArrayMap):["x","y"]:a.pointArrayMap||["y"]},h=[];var x=0;this.setUpKeyToAxis();this.series.forEach(function(a){var g=a.xAxis,l=a.options.keys||w(a,g),e=l.length,m=!a.requireSorting&&{},y=f.indexOf(g),A=G(a,l),k;if(!1!==a.options.includeInDataExport&&
!a.options.isInternal&&!1!==a.visible){D(h,function(a){return a[0]===y})||h.push([y,x]);for(k=0;k<e;)n=F(a,l[k],l.length),C.push(n.columnTitle||n),b&&p.push(n.topLevelColumnTitle||n),k++;var J={chart:a.chart,autoIncrement:a.autoIncrement,options:a.options,pointArrayMap:a.pointArrayMap};a.options.data.forEach(function(b,h){d&&(A=G(a,l,h));var w={series:J};a.pointClass.prototype.applyOptions.apply(w,[b]);b=w.x;var f=a.data[h]&&a.data[h].name;k=0;if(!g||"name"===a.exportKey||!d&&g&&g.hasNames&&f)b=f;
m&&(m[b]&&(b+="|"+h),m[b]=!0);r[b]||(r[b]=[],r[b].xValues=[]);r[b].x=w.x;r[b].name=f;for(r[b].xValues[y]=w.x;k<e;)h=l[k],f=w[h],r[b][x+k]=v(A.categoryMap[h][f],A.dateTimeValueAxisMap[h]?c.dateFormat(t.dateFormat,f):null,f),k++});x+=k}});for(m in r)Object.hasOwnProperty.call(r,m)&&e.push(r[m]);var m=b?[p,C]:[C];for(x=h.length;x--;){var q=h[x][0];var u=h[x][1];var z=f[q];e.sort(function(a,b){return a.xValues[q]-b.xValues[q]});k=F(z);m[0].splice(u,0,k);b&&m[1]&&m[1].splice(u,0,k);e.forEach(function(a){var b=
a.name;z&&!I(b)&&(z.dateTime?(a.x instanceof Date&&(a.x=a.x.getTime()),b=c.dateFormat(t.dateFormat,a.x)):b=z.categories?v(z.names[a.x],z.categories[a.x],a.x):a.x);a.splice(u,0,b)})}m=m.concat(e);B(this,"exportData",{dataRows:m});return m};b.prototype.getCSV=function(a){var b="",d=this.getDataRows(),c=this.options.exporting.csv,f=v(c.decimalPoint,","!==c.itemDelimiter&&a?(1.1).toLocaleString()[1]:"."),t=v(c.itemDelimiter,","===f?";":","),e=c.lineDelimiter;d.forEach(function(a,c){for(var n,k=a.length;k--;)n=
a[k],"string"===typeof n&&(n='"'+n+'"'),"number"===typeof n&&"."!==f&&(n=n.toString().replace(".",f)),a[k]=n;b+=a.join(t);c<d.length-1&&(b+=e)});return b};b.prototype.getTable=function(a){var b='<table id="highcharts-data-table-'+this.index+'">',c=this.options,d=a?(1.1).toLocaleString()[1]:".",f=v(c.exporting.useMultiLevelHeaders,!0);a=this.getDataRows(f);var e=0,p=f?a.shift():null,t=a.shift(),q=function(a,b,c,f){var g=v(f,"");b="text"+(b?" "+b:"");"number"===typeof g?(g=g.toString(),","===d&&(g=
g.replace(".",d)),b="number"):f||(b="empty");return"<"+a+(c?" "+c:"")+' class="'+b+'">'+g+"</"+a+">"};!1!==c.exporting.tableCaption&&(b+='<caption class="highcharts-table-caption">'+v(c.exporting.tableCaption,c.title.text?c.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var n=0,k=a.length;n<k;++n)a[n].length>e&&(e=a[n].length);b+=function(a,b,d){var e="<thead>",g=0;d=d||b&&
b.length;var h,k=0;if(h=f&&a&&b){a:if(h=a.length,b.length===h){for(;h--;)if(a[h]!==b[h]){h=!1;break a}h=!0}else h=!1;h=!h}if(h){for(e+="<tr>";g<d;++g){h=a[g];var m=a[g+1];h===m?++k:k?(e+=q("th","highcharts-table-topheading",'scope="col" colspan="'+(k+1)+'"',h),k=0):(h===b[g]?c.exporting.useRowspanHeaders?(m=2,delete b[g]):(m=1,b[g]=""):m=1,e+=q("th","highcharts-table-topheading",'scope="col"'+(1<m?' valign="top" rowspan="'+m+'"':""),h))}e+="</tr>"}if(b){e+="<tr>";g=0;for(d=b.length;g<d;++g)"undefined"!==
typeof b[g]&&(e+=q("th",null,'scope="col"',b[g]));e+="</tr>"}return e+"</thead>"}(p,t,Math.max(e,t.length));b+="<tbody>";a.forEach(function(a){b+="<tr>";for(var c=0;c<e;c++)b+=q(c?"td":"th",null,c?"":'scope="row"',a[c]);b+="</tr>"});b+="</tbody></table>";a={html:b};B(this,"afterGetTable",a);return a.html};b.prototype.downloadCSV=function(){var a=this.getCSV(!0);E(q(a,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(a),this.getFilename()+".csv")};b.prototype.downloadXLS=function(){var a='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+
this.getTable(!0)+"</body></html>";E(q(a,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+p.btoa(unescape(encodeURIComponent(a))),this.getFilename()+".xls")};b.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=u.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv.innerHTML=this.getTable();B(this,"afterViewData",this.dataTableDiv)};if(b=K().exporting)f(b.menuItemDefinitions,
{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}}}),b.buttons&&b.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData");d.map&&(d.map.prototype.exportKey="name");d.mapbubble&&(d.mapbubble.prototype.exportKey="name");d.treemap&&(d.treemap.prototype.exportKey="name")});e(a,"masters/modules/export-data.src.js",
[],function(){})});
//# sourceMappingURL=export-data.js.map