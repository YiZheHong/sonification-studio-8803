/*
 Highcharts JS v8.0.0 (2020-02-13)

 Sankey diagram module

 (c) 2010-2019 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(n){b(n);b.Highcharts=n;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function n(b,m,g,n){b.hasOwnProperty(m)||(b[m]=n.apply(null,g))}b=b?b._modules:{};n(b,"mixins/nodes.js",[b["parts/Globals.js"],b["parts/Utilities.js"]],function(b,m){var g=m.defined,q=m.extend,n=m.pick,k=b.Point;b.NodesMixin=
{createNode:function(g){function f(a,d){return b.find(a,function(a){return a.id===d})}var a=f(this.nodes,g),d=this.pointClass;if(!a){var v=this.options.nodes&&f(this.options.nodes,g);a=(new d).init(this,q({className:"highcharts-node",isNode:!0,id:g,y:1},v));a.linksTo=[];a.linksFrom=[];a.formatPrefix="node";a.name=a.name||a.options.id;a.mass=n(a.options.mass,a.options.marker&&a.options.marker.radius,this.options.marker&&this.options.marker.radius,4);a.getSum=function(){var d=0,b=0;a.linksTo.forEach(function(a){d+=
a.weight});a.linksFrom.forEach(function(a){b+=a.weight});return Math.max(d,b)};a.offset=function(d,b){for(var e=0,t=0;t<a[b].length;t++){if(a[b][t]===d)return e;e+=a[b][t].weight}};a.hasShape=function(){var d=0;a.linksTo.forEach(function(a){a.outgoing&&d++});return!a.linksTo.length||d!==a.linksTo.length};this.nodes.push(a)}return a},generatePoints:function(){var k=this.chart,f={};b.Series.prototype.generatePoints.call(this);this.nodes||(this.nodes=[]);this.colorCounter=0;this.nodes.forEach(function(a){a.linksFrom.length=
0;a.linksTo.length=0;a.level=a.options.level});this.points.forEach(function(a){g(a.from)&&(f[a.from]||(f[a.from]=this.createNode(a.from)),f[a.from].linksFrom.push(a),a.fromNode=f[a.from],k.styledMode?a.colorIndex=n(a.options.colorIndex,f[a.from].colorIndex):a.color=a.options.color||f[a.from].color);g(a.to)&&(f[a.to]||(f[a.to]=this.createNode(a.to)),f[a.to].linksTo.push(a),a.toNode=f[a.to]);a.name=a.name||a.id},this);this.nodeLookup=f},setData:function(){this.nodes&&(this.nodes.forEach(function(b){b.destroy()}),
this.nodes.length=0);b.Series.prototype.setData.apply(this,arguments)},destroy:function(){this.data=[].concat(this.points||[],this.nodes);return b.Series.prototype.destroy.apply(this,arguments)},setNodeState:function(b){var f=arguments,a=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==b&&a.forEach(function(a){a&&a.series&&(k.prototype.setState.apply(a,f),a.isNode||(a.fromNode.graphic&&k.prototype.setState.apply(a.fromNode,f),a.toNode&&a.toNode.graphic&&k.prototype.setState.apply(a.toNode,
f)))});k.prototype.setState.apply(this,f)}}});n(b,"mixins/tree-series.js",[b["parts/Color.js"],b["parts/Utilities.js"]],function(b,m){var g=m.extend,n=m.isArray,q=m.isNumber,k=m.isObject,x=m.merge,f=m.pick;return{getColor:function(a,d){var v=d.index,g=d.mapOptionsToLevel,k=d.parentColor,e=d.parentColorIndex,t=d.series,c=d.colors,r=d.siblings,p=t.points,l=t.chart.options.chart,h;if(a){p=p[a.i];a=g[a.level]||{};if(g=p&&a.colorByPoint){var u=p.index%(c?c.length:l.colorCount);var I=c&&c[u]}if(!t.chart.styledMode){c=
p&&p.options.color;l=a&&a.color;if(h=k)h=(h=a&&a.colorVariation)&&"brightness"===h.key?b.parse(k).brighten(v/r*h.to).get():k;h=f(c,l,I,h,t.color)}var q=f(p&&p.options.colorIndex,a&&a.colorIndex,u,e,d.colorIndex)}return{color:h,colorIndex:q}},getLevelOptions:function(a){var d=null;if(k(a)){d={};var b=q(a.from)?a.from:1;var f=a.levels;var m={};var e=k(a.defaults)?a.defaults:{};n(f)&&(m=f.reduce(function(a,c){if(k(c)&&q(c.level)){var r=x({},c);var p="boolean"===typeof r.levelIsConstant?r.levelIsConstant:
e.levelIsConstant;delete r.levelIsConstant;delete r.level;c=c.level+(p?0:b-1);k(a[c])?g(a[c],r):a[c]=r}return a},{}));f=q(a.to)?a.to:1;for(a=0;a<=f;a++)d[a]=x({},e,k(m[a])?m[a]:{})}return d},setTreeValues:function y(d,b){var k=b.before,e=b.idRoot,t=b.mapIdToNode[e],c=b.points[d.i],r=c&&c.options||{},p=0,l=[];g(d,{levelDynamic:d.level-(("boolean"===typeof b.levelIsConstant?b.levelIsConstant:1)?0:t.level),name:f(c&&c.name,""),visible:e===d.id||("boolean"===typeof b.visible?b.visible:!1)});"function"===
typeof k&&(d=k(d,b));d.children.forEach(function(c,e){var r=g({},b);g(r,{index:e,siblings:d.children.length,visible:d.visible});c=y(c,r);l.push(c);c.visible&&(p+=c.val)});d.visible=0<p||d.visible;k=f(r.value,p);g(d,{children:l,childrenTotal:p,isLeaf:d.visible&&!p,val:k});return d},updateRootId:function(b){if(k(b)){var d=k(b.options)?b.options:{};d=f(b.rootNode,d.rootId,"");k(b.userOptions)&&(b.userOptions.rootId=d);b.rootNode=d}return d}}});n(b,"modules/sankey.src.js",[b["parts/Globals.js"],b["parts/Color.js"],
b["parts/Utilities.js"],b["mixins/tree-series.js"]],function(b,m,g,n){var q=g.defined,k=g.isObject,x=g.merge,f=g.pick,a=g.relativeLength,d=g.stableSort,v=n.getLevelOptions,y=b.find;g=b.seriesType;var A=b.Point;g("sankey","column",{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,minLinkWidth:0,nodeWidth:20,
nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 10px">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}},{isCartesian:!1,invertable:!0,forceDL:!0,orderNodes:!0,pointArrayMap:["from","to"],createNode:b.NodesMixin.createNode,setData:b.NodesMixin.setData,
destroy:b.NodesMixin.destroy,getNodePadding:function(){var a=this.options.nodePadding||0;if(this.nodeColumns){var b=this.nodeColumns.reduce(function(a,b){return Math.max(a,b.length)},0);b*a>this.chart.plotSizeY&&(a=this.chart.plotSizeY/b)}return a},createNodeColumn:function(){var b=this,t=this.chart,c=[];c.sum=function(){return this.reduce(function(a,c){return a+c.getSum()},0)};c.offset=function(e,p){for(var r=0,h,t=b.nodePadding,d=0;d<c.length;d++){h=(h=c[d].getSum())?h*p+t:0;if(c[d]===e)return{relativeTop:r+
a(e.options.offset||0,h)};r+=h}};c.top=function(a){var c=b.nodePadding,e=this.reduce(function(b,e){0<b&&(b+=c);return b+=e.getSum()*a},0);return(t.plotSizeY-e)/2};return c},createNodeColumns:function(){var a=[];this.nodes.forEach(function(c){var b=-1,e;if(!q(c.options.column))if(0===c.linksTo.length)c.column=0;else{for(e=0;e<c.linksTo.length;e++){var d=c.linksTo[0];if(d.fromNode.column>b){var h=d.fromNode;b=h.column}}c.column=b+1;h&&"hanging"===h.options.layout&&(c.hangsFrom=h,e=-1,y(h.linksFrom,
function(a,b){(a=a.toNode===c)&&(e=b);return a}),c.column+=e)}a[c.column]||(a[c.column]=this.createNodeColumn());a[c.column].push(c)},this);for(var b=0;b<a.length;b++)"undefined"===typeof a[b]&&(a[b]=this.createNodeColumn());return a},hasData:function(){return!!this.processedXData.length},pointAttribs:function(a,b){var c=this,e=c.mapOptionsToLevel[(a.isNode?a.level:a.fromNode.level)||0]||{},p=a.options,d=e.states&&e.states[b]||{};b=["colorByPoint","borderColor","borderWidth","linkOpacity"].reduce(function(a,
b){a[b]=f(d[b],p[b],e[b],c.options[b]);return a},{});var h=f(d.color,p.color,b.colorByPoint?a.color:e.color);return a.isNode?{fill:h,stroke:b.borderColor,"stroke-width":b.borderWidth}:{fill:m.parse(h).setOpacity(b.linkOpacity).get()}},generatePoints:function(){function a(b,c){"undefined"===typeof b.level&&(b.level=c,b.linksFrom.forEach(function(b){b.toNode&&a(b.toNode,c+1)}))}b.NodesMixin.generatePoints.apply(this,arguments);this.orderNodes&&(this.nodes.filter(function(a){return 0===a.linksTo.length}).forEach(function(b){a(b,
0)}),d(this.nodes,function(a,b){return a.level-b.level}))},translateNode:function(a,b){var c=this.translationFactor,d=this.chart,e=this.options,l=a.getSum(),h=Math.round(l*c),u=Math.round(e.borderWidth)%2/2,g=b.offset(a,c);b=Math.floor(f(g.absoluteTop,b.top(c)+g.relativeTop))+u;u=Math.floor(this.colDistance*a.column+e.borderWidth/2)+u;u=d.inverted?d.plotSizeX-u:u;c=Math.round(this.nodeWidth);(a.sum=l)?(a.shapeType="rect",a.nodeX=u,a.nodeY=b,a.shapeArgs=d.inverted?{x:u-c,y:d.plotSizeY-b-h,width:a.options.height||
e.height||c,height:a.options.width||e.width||h}:{x:u,y:b,width:a.options.width||e.width||c,height:a.options.height||e.height||h},a.shapeArgs.display=a.hasShape()?"":"none",d=this.mapOptionsToLevel[a.level],e=a.options,e=k(e)?e.dataLabels:{},d=k(d)?d.dataLabels:{},d=x({style:{}},d,e),a.dlOptions=d,a.plotY=1):a.dlOptions={enabled:!1}},translateLink:function(a){var b=a.fromNode,c=a.toNode,d=this.chart,e=this.translationFactor,l=Math.max(a.weight*e,this.options.minLinkWidth),h=this.options,f=b.offset(a,
"linksFrom")*e,g=(d.inverted?-this.colDistance:this.colDistance)*h.curveFactor;f=b.nodeY+f;h=b.nodeX;e=this.nodeColumns[c.column].top(e)+c.offset(a,"linksTo")*e+this.nodeColumns[c.column].offset(c,e).relativeTop;var k=this.nodeWidth;c=c.column*this.colDistance;var m=a.outgoing,n=c>h;d.inverted&&(f=d.plotSizeY-f,e=d.plotSizeY-e,c=d.plotSizeX-c,k=-k,l=-l,n=h>c);a.shapeType="path";a.linkBase=[f,f+l,e,e+l];if(n)a.shapeArgs={d:["M",h+k,f,"C",h+k+g,f,c-g,e,c,e,"L",c+(m?k:0),e+l/2,"L",c,e+l,"C",c-g,e+l,
h+k+g,f+l,h+k,f+l,"z"]};else{g=c-20-l;m=c-20;n=c;var q=h+k,z=q+20,v=z+l,x=f,B=f+l,y=B+20;d=y+(d.plotHeight-f-l);var w=d+20,D=w+l,E=e,C=E+l,A=C+20,F=w+.7*l,G=n-.7*l,H=q+.7*l;a.shapeArgs={d:["M",q,x,"C",H,x,v,B-.7*l,v,y,"L",v,d,"C",v,F,H,D,q,D,"L",n,D,"C",G,D,g,F,g,d,"L",g,A,"C",g,C-.7*l,G,E,n,E,"L",n,C,"C",m,C,m,C,m,A,"L",m,d,"C",m,w,m,w,n,w,"L",q,w,"C",z,w,z,w,z,d,"L",z,y,"C",z,B,z,B,q,B,"z"]}}a.dlBox={x:h+(c-h+k)/2,y:f+(e-f)/2,height:l,width:0};a.y=a.plotY=1;a.color||(a.color=b.color)},translate:function(){this.processedXData||
this.processData();this.generatePoints();this.nodeColumns=this.createNodeColumns();this.nodeWidth=a(this.options.nodeWidth,this.chart.plotSizeX);var b=this,d=this.chart,c=this.options,f=this.nodeWidth,g=this.nodeColumns;this.nodePadding=this.getNodePadding();this.translationFactor=g.reduce(function(a,e){return Math.min(a,(d.plotSizeY-c.borderWidth-(e.length-1)*b.nodePadding)/e.sum())},Infinity);this.colDistance=(d.plotSizeX-f-c.borderWidth)/Math.max(1,g.length-1);b.mapOptionsToLevel=v({from:1,levels:c.levels,
to:g.length-1,defaults:{borderColor:c.borderColor,borderRadius:c.borderRadius,borderWidth:c.borderWidth,color:b.color,colorByPoint:c.colorByPoint,levelIsConstant:!0,linkColor:c.linkColor,linkLineWidth:c.linkLineWidth,linkOpacity:c.linkOpacity,states:c.states}});g.forEach(function(a){a.forEach(function(c){b.translateNode(c,a)})},this);this.nodes.forEach(function(a){a.linksFrom.forEach(function(a){(a.weight||a.isNull)&&a.to&&(b.translateLink(a),a.allowShadow=!1)})})},render:function(){var a=this.points;
this.points=this.points.concat(this.nodes||[]);b.seriesTypes.column.prototype.render.call(this);this.points=a},animate:b.Series.prototype.animate},{applyOptions:function(a,b){A.prototype.applyOptions.call(this,a,b);q(this.options.level)&&(this.options.column=this.column=this.options.level);return this},setState:b.NodesMixin.setNodeState,getClassName:function(){return(this.isNode?"highcharts-node ":"highcharts-link ")+A.prototype.getClassName.call(this)},isValid:function(){return this.isNode||"number"===
typeof this.weight}});""});n(b,"masters/modules/sankey.src.js",[],function(){})});
//# sourceMappingURL=sankey.js.map